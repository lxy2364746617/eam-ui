{"remainingRequest":"E:\\qrhpro\\cms-eam-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\qrhpro\\cms-eam-ui\\src\\components\\Process\\PropertyPanel.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\qrhpro\\cms-eam-ui\\src\\components\\Process\\PropertyPanel.vue","mtime":1693791858967},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693791616229},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1693791596985},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693791616229},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1693791844037}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgdGFza1BhbmVsIGZyb20gJy4vY29tcG9uZW50cy9ub2RlUGFuZWwvdGFzaycNCmltcG9ydCBzdGFydEVuZFBhbmVsIGZyb20gJy4vY29tcG9uZW50cy9ub2RlUGFuZWwvc3RhcnRFbmQnDQppbXBvcnQgcHJvY2Vzc1BhbmVsIGZyb20gJy4vY29tcG9uZW50cy9ub2RlUGFuZWwvcHJvY2VzcycNCmltcG9ydCBzZXF1ZW5jZUZsb3dQYW5lbCBmcm9tICcuL2NvbXBvbmVudHMvbm9kZVBhbmVsL3NlcXVlbmNlRmxvdycNCmltcG9ydCBnYXRld2F5UGFuZWwgZnJvbSAnLi9jb21wb25lbnRzL25vZGVQYW5lbC9nYXRld2F5Jw0KaW1wb3J0IHsgTm9kZU5hbWUgfSBmcm9tICcuL2xhbmcvemgnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ1Byb3BlcnR5UGFuZWwnLA0KICBjb21wb25lbnRzOiB7IHByb2Nlc3NQYW5lbCwgdGFza1BhbmVsLCBzdGFydEVuZFBhbmVsLCBzZXF1ZW5jZUZsb3dQYW5lbCwgZ2F0ZXdheVBhbmVsIH0sDQogIHByb3BzOiB7DQogICAgdXNlcnM6IHsNCiAgICAgIHR5cGU6IEFycmF5LA0KICAgICAgcmVxdWlyZWQ6IHRydWUNCiAgICB9LA0KICAgIGdyb3Vwczogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQogICAgY2F0ZWdvcnlzOiB7DQogICAgICB0eXBlOiBBcnJheSwNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfSwNCiAgICBleHBzOiB7DQogICAgICB0eXBlOiBBcnJheSwNCiAgICAgIGRlZmF1bHQ6ICgpID0+IFtdDQogICAgfSwNCiAgICBtb2RlbGVyOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZWxlbWVudDogbnVsbCwNCiAgICAgIGZvcm06IHsNCiAgICAgICAgaWQ6ICcnLA0KICAgICAgICBuYW1lOiAnJywNCiAgICAgICAgY29sb3I6IG51bGwNCiAgICAgIH0sDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGdldENvbXBvbmVudCgpIHsNCiAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLmVsZW1lbnQ/LnR5cGUNCiAgICAgIGlmIChbJ2JwbW46SW50ZXJtZWRpYXRlVGhyb3dFdmVudCcsICdicG1uOlN0YXJ0RXZlbnQnLCAnYnBtbjpFbmRFdmVudCddLmluY2x1ZGVzKHR5cGUpKSB7DQogICAgICAgIHJldHVybiAnc3RhcnRFbmRQYW5lbCcNCiAgICAgIH0NCiAgICAgIGlmIChbDQogICAgICAgICdicG1uOlVzZXJUYXNrJywNCiAgICAgICAgJ2JwbW46VGFzaycsDQogICAgICAgICdicG1uOlNlbmRUYXNrJywNCiAgICAgICAgJ2JwbW46UmVjZWl2ZVRhc2snLA0KICAgICAgICAnYnBtbjpNYW51YWxUYXNrJywNCiAgICAgICAgJ2JwbW46QnVzaW5lc3NSdWxlVGFzaycsDQogICAgICAgICdicG1uOlNlcnZpY2VUYXNrJywNCiAgICAgICAgJ2JwbW46U2NyaXB0VGFzaycNCiAgICAgICAgLy8gJ2JwbW46Q2FsbEFjdGl2aXR5JywNCiAgICAgICAgLy8gJ2JwbW46U3ViUHJvY2VzcycNCiAgICAgIF0uaW5jbHVkZXModHlwZSkpIHsNCiAgICAgICAgcmV0dXJuICd0YXNrUGFuZWwnDQogICAgICB9DQogICAgICBpZiAodHlwZSA9PT0gJ2JwbW46U2VxdWVuY2VGbG93Jykgew0KICAgICAgICByZXR1cm4gJ3NlcXVlbmNlRmxvd1BhbmVsJw0KICAgICAgfQ0KICAgICAgaWYgKFsNCiAgICAgICAgJ2JwbW46SW5jbHVzaXZlR2F0ZXdheScsDQogICAgICAgICdicG1uOkV4Y2x1c2l2ZUdhdGV3YXknLA0KICAgICAgICAnYnBtbjpQYXJhbGxlbEdhdGV3YXknLA0KICAgICAgICAnYnBtbjpFdmVudEJhc2VkR2F0ZXdheScNCiAgICAgIF0uaW5jbHVkZXModHlwZSkpIHsNCiAgICAgICAgcmV0dXJuICdnYXRld2F5UGFuZWwnDQogICAgICB9DQogICAgICBpZiAodHlwZSA9PT0gJ2JwbW46UHJvY2VzcycpIHsNCiAgICAgICAgcmV0dXJuICdwcm9jZXNzUGFuZWwnDQogICAgICB9DQogICAgICByZXR1cm4gbnVsbA0KICAgIH0sDQogICAgbm9kZU5hbWUoKSB7DQogICAgICBpZiAodGhpcy5lbGVtZW50KSB7DQogICAgICAgIGNvbnN0IGJpek9iaiA9IHRoaXMuZWxlbWVudC5idXNpbmVzc09iamVjdA0KICAgICAgICBjb25zdCB0eXBlID0gYml6T2JqPy5ldmVudERlZmluaXRpb25zDQogICAgICAgICAgPyBiaXpPYmouZXZlbnREZWZpbml0aW9uc1swXS4kdHlwZQ0KICAgICAgICAgIDogYml6T2JqLiR0eXBlDQogICAgICAgIHJldHVybiBOb2RlTmFtZVt0eXBlXSB8fCB0eXBlDQogICAgICB9DQogICAgICByZXR1cm4gJycNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5oYW5kbGVNb2RlbGVyKCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGhhbmRsZU1vZGVsZXIoKSB7DQogICAgICB0aGlzLm1vZGVsZXIub24oJ3Jvb3QuYWRkZWQnLCBlID0+IHsNCiAgICAgICAgaWYgKGUuZWxlbWVudC50eXBlID09PSAnYnBtbjpQcm9jZXNzJykgew0KICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGwNCiAgICAgICAgICB0aGlzLiRuZXh0VGljaygpLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZS5lbGVtZW50DQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICAgIHRoaXMubW9kZWxlci5vbignZWxlbWVudC5jbGljaycsIGUgPT4gew0KICAgICAgICBjb25zdCB7IGVsZW1lbnQgfSA9IGUNCiAgICAgICAgaWYgKGVsZW1lbnQudHlwZSA9PT0gJ2JwbW46UHJvY2VzcycNCiAgICAgICAgICB8fCBlbGVtZW50LnR5cGUgPT09ICdicG1uOlNlcXVlbmNlRmxvdycNCiAgICAgICAgICB8fCBlbGVtZW50LnR5cGUgPT09ICdicG1uOkVuZEV2ZW50JyApIHsNCiAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgICB0aGlzLm1vZGVsZXIub24oJ3NlbGVjdGlvbi5jaGFuZ2VkJywgZSA9PiB7DQogICAgICAgIC8vIGhhY2sg5ZCM57G75Z6L6Z2i5p2/5LiN5Yi35pawDQogICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGwNCiAgICAgICAgY29uc3QgZWxlbWVudCA9IGUubmV3U2VsZWN0aW9uWzBdDQogICAgICAgIGlmIChlbGVtZW50KSB7DQogICAgICAgICAgdGhpcy4kbmV4dFRpY2soKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogIH0NCn0NCg=="},{"version":3,"sources":["PropertyPanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PropertyPanel.vue","sourceRoot":"src/components/Process","sourcesContent":["<template>\r\n  <div ref=\"propertyPanel\" class=\"property-panel\">\r\n    <div v-if=\"nodeName\" class=\"node-name\">{{ nodeName }}</div>\r\n    <component\r\n      :is=\"getComponent\"\r\n      v-if=\"element\"\r\n      :element=\"element\"\r\n      :modeler=\"modeler\"\r\n      :users=\"users\"\r\n      :groups=\"groups\"\r\n      :exps=\"exps\"\r\n      :categorys=\"categorys\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport taskPanel from './components/nodePanel/task'\r\nimport startEndPanel from './components/nodePanel/startEnd'\r\nimport processPanel from './components/nodePanel/process'\r\nimport sequenceFlowPanel from './components/nodePanel/sequenceFlow'\r\nimport gatewayPanel from './components/nodePanel/gateway'\r\nimport { NodeName } from './lang/zh'\r\n\r\nexport default {\r\n  name: 'PropertyPanel',\r\n  components: { processPanel, taskPanel, startEndPanel, sequenceFlowPanel, gatewayPanel },\r\n  props: {\r\n    users: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    groups: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    categorys: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    exps: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    modeler: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      element: null,\r\n      form: {\r\n        id: '',\r\n        name: '',\r\n        color: null\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    getComponent() {\r\n      const type = this.element?.type\r\n      if (['bpmn:IntermediateThrowEvent', 'bpmn:StartEvent', 'bpmn:EndEvent'].includes(type)) {\r\n        return 'startEndPanel'\r\n      }\r\n      if ([\r\n        'bpmn:UserTask',\r\n        'bpmn:Task',\r\n        'bpmn:SendTask',\r\n        'bpmn:ReceiveTask',\r\n        'bpmn:ManualTask',\r\n        'bpmn:BusinessRuleTask',\r\n        'bpmn:ServiceTask',\r\n        'bpmn:ScriptTask'\r\n        // 'bpmn:CallActivity',\r\n        // 'bpmn:SubProcess'\r\n      ].includes(type)) {\r\n        return 'taskPanel'\r\n      }\r\n      if (type === 'bpmn:SequenceFlow') {\r\n        return 'sequenceFlowPanel'\r\n      }\r\n      if ([\r\n        'bpmn:InclusiveGateway',\r\n        'bpmn:ExclusiveGateway',\r\n        'bpmn:ParallelGateway',\r\n        'bpmn:EventBasedGateway'\r\n      ].includes(type)) {\r\n        return 'gatewayPanel'\r\n      }\r\n      if (type === 'bpmn:Process') {\r\n        return 'processPanel'\r\n      }\r\n      return null\r\n    },\r\n    nodeName() {\r\n      if (this.element) {\r\n        const bizObj = this.element.businessObject\r\n        const type = bizObj?.eventDefinitions\r\n          ? bizObj.eventDefinitions[0].$type\r\n          : bizObj.$type\r\n        return NodeName[type] || type\r\n      }\r\n      return ''\r\n    }\r\n  },\r\n  mounted() {\r\n    this.handleModeler()\r\n  },\r\n  methods: {\r\n    handleModeler() {\r\n      this.modeler.on('root.added', e => {\r\n        if (e.element.type === 'bpmn:Process') {\r\n          this.element = null\r\n          this.$nextTick().then(() => {\r\n            this.element = e.element\r\n          })\r\n        }\r\n      })\r\n      this.modeler.on('element.click', e => {\r\n        const { element } = e\r\n        if (element.type === 'bpmn:Process'\r\n          || element.type === 'bpmn:SequenceFlow'\r\n          || element.type === 'bpmn:EndEvent' ) {\r\n          this.element = element\r\n        }\r\n      })\r\n      this.modeler.on('selection.changed', e => {\r\n        // hack 同类型面板不刷新\r\n        this.element = null\r\n        const element = e.newSelection[0]\r\n        if (element) {\r\n          this.$nextTick().then(() => {\r\n            this.element = element\r\n          })\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.property-panel {\r\n  padding: 20px 20px;\r\n  // reset element css\r\n  .el-form--label-top .el-form-item__label {\r\n    padding: 0;\r\n  }\r\n  // 设置设计器右侧表单高度\r\n  .el-form-item {\r\n    margin-bottom: 6px;\r\n  }\r\n  .tab-table .el-form-item {\r\n    margin-bottom: 16px;\r\n  }\r\n  .node-name{\r\n    border-bottom: 1px solid #ccc;\r\n    padding: 0 0 10px 20px;\r\n    margin-bottom: 10px;\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n    color: #444;\r\n  }\r\n}\r\n</style>\r\n"]}]}