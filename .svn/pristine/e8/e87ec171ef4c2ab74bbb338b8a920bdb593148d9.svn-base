{"remainingRequest":"E:\\visual_code_work_space\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\visual_code_work_space\\ruoyi-ui\\src\\views\\flowable\\task\\myProcess\\detail\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\visual_code_work_space\\ruoyi-ui\\src\\views\\flowable\\task\\myProcess\\detail\\index.vue","mtime":1693557459674},{"path":"E:\\visual_code_work_space\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\visual_code_work_space\\ruoyi-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\visual_code_work_space\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\visual_code_work_space\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge2Zsb3dSZWNvcmR9IGZyb20gIkAvYXBpL2Zsb3dhYmxlL2ZpbmlzaGVkIjsNCmltcG9ydCBQYXJzZXIgZnJvbSAnQC9jb21wb25lbnRzL3BhcnNlci9QYXJzZXInDQppbXBvcnQge2dldFByb2Nlc3NWYXJpYWJsZXMsIHJlYWRYbWwsIGdldEZsb3dWaWV3ZXIsIGdldEhpZ2hsaWdodCwgZmxvd1htbEFuZE5vZGV9IGZyb20gIkAvYXBpL2Zsb3dhYmxlL2RlZmluaXRpb24iOw0KaW1wb3J0IGZsb3cgZnJvbSAnQC92aWV3cy9mbG93YWJsZS90YXNrL215UHJvY2Vzcy9kZXRhaWwvZmxvdycNCmltcG9ydCAiQHJpb3BoYWUvdnVlLXRyZWVzZWxlY3QvZGlzdC92dWUtdHJlZXNlbGVjdC5jc3MiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJSZWNvcmQiLA0KICBjb21wb25lbnRzOiB7DQogICAgUGFyc2VyLA0KICAgIGZsb3cNCiAgfSwNCiAgcHJvcHM6IHt9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICAvLyDmqKHlnot4bWzmlbDmja4NCiAgICAgIGZsb3dEYXRhOiB7fSwNCiAgICAgIGFjdGl2ZU5hbWU6ICcxJywNCiAgICAgIC8vIOafpeivouWPguaVsA0KICAgICAgcXVlcnlQYXJhbXM6IHsNCiAgICAgICAgZGVwdElkOiB1bmRlZmluZWQNCiAgICAgIH0sDQogICAgICAvLyDpga7nvanlsYINCiAgICAgIGxvYWRpbmc6IHRydWUsDQogICAgICBmbG93UmVjb3JkTGlzdDogW10sIC8vIOa1geeoi+a1gei9rOaVsOaNrg0KICAgICAgdGFza0Zvcm06ew0KICAgICAgICBtdWx0aXBsZTogZmFsc2UsDQogICAgICAgIGNvbW1lbnQ6IiIsIC8vIOaEj+ingeWGheWuuQ0KICAgICAgICBwcm9jSW5zSWQ6ICIiLCAvLyDmtYHnqIvlrp7kvovnvJblj7cNCiAgICAgICAgaW5zdGFuY2VJZDogIiIsIC8vIOa1geeoi+WunuS+i+e8luWPtw0KICAgICAgICBkZXBsb3lJZDogIiIsICAvLyDmtYHnqIvlrprkuYnnvJblj7cNCiAgICAgICAgdGFza0lkOiAiIiAsLy8g5rWB56iL5Lu75Yqh57yW5Y+3DQogICAgICAgIHByb2NEZWZJZDogIiIsICAvLyDmtYHnqIvnvJblj7cNCiAgICAgIH0sDQogICAgICB2YXJpYWJsZXNEYXRhOiB7fSwgLy8g5rWB56iL5Y+Y6YeP5pWw5o2uDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLnRhc2tGb3JtLmRlcGxveUlkID0gdGhpcy4kcm91dGUucXVlcnkgJiYgdGhpcy4kcm91dGUucXVlcnkuZGVwbG95SWQ7DQogICAgdGhpcy50YXNrRm9ybS50YXNrSWQgID0gdGhpcy4kcm91dGUucXVlcnkgJiYgdGhpcy4kcm91dGUucXVlcnkudGFza0lkOw0KICAgIHRoaXMudGFza0Zvcm0ucHJvY0luc0lkID0gdGhpcy4kcm91dGUucXVlcnkgJiYgdGhpcy4kcm91dGUucXVlcnkucHJvY0luc0lkOw0KICAgIC8vIOWbnuaYvua1geeoi+iusOW9lQ0KICAgIC8vIOa1geeoi+S7u+WKoemHjeiOt+WPluWPmOmHj+ihqOWNlQ0KICAgIHRoaXMucHJvY2Vzc1ZhcmlhYmxlcyggdGhpcy50YXNrRm9ybS50YXNrSWQpDQogICAgdGhpcy5nZXRGbG93UmVjb3JkTGlzdCh0aGlzLnRhc2tGb3JtLnByb2NJbnNJZCwgdGhpcy50YXNrRm9ybS5kZXBsb3lJZCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBoYW5kbGVDbGljayh0YWIsIGV2ZW50KSB7DQogICAgICBpZiAodGFiLm5hbWUgPT09ICczJyl7DQogICAgICAgIGZsb3dYbWxBbmROb2RlKHtwcm9jSW5zSWQ6dGhpcy50YXNrRm9ybS5wcm9jSW5zSWQsZGVwbG95SWQ6dGhpcy50YXNrRm9ybS5kZXBsb3lJZH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLmZsb3dEYXRhID0gcmVzLmRhdGE7DQogICAgICAgIH0pDQogICAgICB9DQogICAgfSwNCiAgICBnZXRGbG93Vmlld2VyKHByb2NJbnNJZCxleGVjdXRpb25JZCkgew0KICAgICAgZ2V0Rmxvd1ZpZXdlcihwcm9jSW5zSWQsZXhlY3V0aW9uSWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy50YXNrTGlzdCA9IHJlcy5kYXRhDQogICAgICB9KQ0KICAgIH0sDQogICAgc2V0SWNvbih2YWwpIHsNCiAgICAgIGlmICh2YWwpIHsNCiAgICAgICAgcmV0dXJuICJlbC1pY29uLWNoZWNrIjsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAiZWwtaWNvbi10aW1lIjsNCiAgICAgIH0NCiAgICB9LA0KICAgIHNldENvbG9yKHZhbCkgew0KICAgICAgaWYgKHZhbCkgew0KICAgICAgICByZXR1cm4gIiMyYmM0MTgiOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICIjYjNiZGJiIjsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8qKiDmtYHnqIvmtYHovazorrDlvZUgKi8NCiAgICBnZXRGbG93UmVjb3JkTGlzdChwcm9jSW5zSWQsIGRlcGxveUlkKSB7DQogICAgICBjb25zdCB0aGF0ID0gdGhpcw0KICAgICAgY29uc3QgcGFyYW1zID0ge3Byb2NJbnNJZDogcHJvY0luc0lkLCBkZXBsb3lJZDogZGVwbG95SWR9DQogICAgICBmbG93UmVjb3JkKHBhcmFtcykudGhlbihyZXMgPT4gew0KICAgICAgICB0aGF0LmZsb3dSZWNvcmRMaXN0ID0gcmVzLmRhdGEuZmxvd0xpc3Q7DQogICAgICB9KS5jYXRjaChyZXMgPT4gew0KICAgICAgICB0aGlzLmdvQmFjaygpOw0KICAgICAgfSkNCiAgICB9LA0KICAgIGZpbGxGb3JtRGF0YShmb3JtLCBkYXRhKSB7DQogICAgICBmb3JtLmZpZWxkcy5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgIGNvbnN0IHZNb2RlbCA9IGl0ZW0uX192TW9kZWxfXzsNCiAgICAgICAgY29uc3QgdmFsID0gZGF0YVtpdGVtLl9fdk1vZGVsX19dOw0KDQogICAgICAgIC8vIOeJueauiuWkhOeQhmVsLXVwbG9hZO+8jOWbnuaYvuWbvueJhw0KICAgICAgICBpZiAoaXRlbS5fX2NvbmZpZ19fLnRhZyA9PT0gImVsLXVwbG9hZCIpIHsNCiAgICAgICAgICAvLyDlm57mmL7lm77niYcNCiAgICAgICAgICBpdGVtWyJmaWxlLWxpc3QiXSA9ICh2YWwgfHwgW10pLm1hcCgodXJsKSA9PiAoew0KICAgICAgICAgICAgbmFtZTogYCR7dk1vZGVsfSR7aX1gLA0KICAgICAgICAgICAgdXJsLA0KICAgICAgICAgIH0pKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh2YWwpIHsNCiAgICAgICAgICBpdGVtLl9fY29uZmlnX18uZGVmYXVsdFZhbHVlID0gdmFsOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8qKiDojrflj5bmtYHnqIvlj5jph4/lhoXlrrkgKi8NCiAgICBwcm9jZXNzVmFyaWFibGVzKHRhc2tJZCkgew0KICAgICAgaWYgKHRhc2tJZCkgew0KICAgICAgICAvLyDmj5DkuqTmtYHnqIvnlLPor7fml7bloavlhpnnmoTooajljZXlrZjlhaXkuobmtYHnqIvlj5jph4/kuK3lkI7nu63ku7vliqHlpITnkIbml7bpnIDopoHlsZXnpLoNCiAgICAgICAgZ2V0UHJvY2Vzc1ZhcmlhYmxlcyh0YXNrSWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLnZhcmlhYmxlc0RhdGEgPSByZXMuZGF0YS52YXJpYWJsZXM7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgLyoqIOi/lOWbnumhtemdoiAqLw0KICAgIGdvQmFjaygpIHsNCiAgICAgIC8vIOWFs+mXreW9k+WJjeagh+etvumhteW5tui/lOWbnuS4iuS4qumhtemdog0KICAgICAgY29uc3Qgb2JqID0geyBwYXRoOiAiL3Rhc2svcHJvY2VzcyIsIHF1ZXJ5OiB7IHQ6IERhdGUubm93KCl9IH07DQogICAgICB0aGlzLiR0YWIuY2xvc2VPcGVuUGFnZShvYmopOw0KICAgIH0sDQogIH0NCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/flowable/task/myProcess/detail","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-card class=\"box-card\" >\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span class=\"el-icon-document\">已发任务</span>\r\n        <el-button style=\"float: right;\" size=\"mini\" type=\"danger\" @click=\"goBack\">关闭</el-button>\r\n      </div>\r\n      <el-tabs  tab-position=\"top\" v-model=\"activeName\" @tab-click=\"handleClick\">\r\n        <!--表单信息-->\r\n        <el-tab-pane label=\"表单信息\" name=\"1\">\r\n          <el-col :span=\"16\" :offset=\"4\">\r\n            <div class=\"test-form\">\r\n                <parser :key=\"new Date().getTime()\" :form-conf=\"variablesData\" />\r\n            </div>\r\n         </el-col>\r\n        </el-tab-pane>\r\n        <!--流程流转记录-->\r\n        <el-tab-pane label=\"流转记录\" name=\"2\">\r\n          <el-col :span=\"16\" :offset=\"4\" >\r\n            <div class=\"block\">\r\n              <el-timeline>\r\n                <el-timeline-item\r\n                  v-for=\"(item,index ) in flowRecordList\"\r\n                  :key=\"index\"\r\n                  :icon=\"setIcon(item.finishTime)\"\r\n                  :color=\"setColor(item.finishTime)\"\r\n                >\r\n                  <p style=\"font-weight: 700\">{{item.taskName}}</p>\r\n                  <el-card :body-style=\"{ padding: '10px' }\">\r\n                    <el-descriptions class=\"margin-top\" :column=\"1\" size=\"small\" border>\r\n                      <el-descriptions-item v-if=\"item.assigneeName\" label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-user\"></i>办理人</template>\r\n                        {{item.assigneeName}}\r\n                        <el-tag type=\"info\" size=\"mini\">{{item.deptName}}</el-tag>\r\n                      </el-descriptions-item>\r\n                      <el-descriptions-item v-if=\"item.candidate\" label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-user\"></i>候选办理</template>\r\n                        {{item.candidate}}\r\n                      </el-descriptions-item>\r\n                      <el-descriptions-item label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-date\"></i>接收时间</template>\r\n                        {{item.createTime}}\r\n                      </el-descriptions-item>\r\n                      <el-descriptions-item v-if=\"item.finishTime\" label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-date\"></i>处理时间</template>\r\n                        {{item.finishTime}}\r\n                      </el-descriptions-item>\r\n                      <el-descriptions-item v-if=\"item.duration\"  label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-time\"></i>耗时</template>\r\n                        {{item.duration}}\r\n                      </el-descriptions-item>\r\n                      <el-descriptions-item v-if=\"item.comment\" label-class-name=\"my-label\">\r\n                        <template slot=\"label\"><i class=\"el-icon-tickets\"></i>处理意见</template>\r\n                        {{item.comment.comment}}\r\n                      </el-descriptions-item>\r\n                    </el-descriptions>\r\n                  </el-card>\r\n                </el-timeline-item>\r\n              </el-timeline>\r\n            </div>\r\n          </el-col>\r\n        </el-tab-pane>\r\n        <!--流程图-->\r\n        <el-tab-pane label=\"流程图\" name=\"3\">\r\n          <flow :flowData=\"flowData\"/>\r\n        </el-tab-pane>\r\n    </el-tabs>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {flowRecord} from \"@/api/flowable/finished\";\r\nimport Parser from '@/components/parser/Parser'\r\nimport {getProcessVariables, readXml, getFlowViewer, getHighlight, flowXmlAndNode} from \"@/api/flowable/definition\";\r\nimport flow from '@/views/flowable/task/myProcess/detail/flow'\r\nimport \"@riophae/vue-treeselect/dist/vue-treeselect.css\";\r\n\r\nexport default {\r\n  name: \"Record\",\r\n  components: {\r\n    Parser,\r\n    flow\r\n  },\r\n  props: {},\r\n  data() {\r\n    return {\r\n      // 模型xml数据\r\n      flowData: {},\r\n      activeName: '1',\r\n      // 查询参数\r\n      queryParams: {\r\n        deptId: undefined\r\n      },\r\n      // 遮罩层\r\n      loading: true,\r\n      flowRecordList: [], // 流程流转数据\r\n      taskForm:{\r\n        multiple: false,\r\n        comment:\"\", // 意见内容\r\n        procInsId: \"\", // 流程实例编号\r\n        instanceId: \"\", // 流程实例编号\r\n        deployId: \"\",  // 流程定义编号\r\n        taskId: \"\" ,// 流程任务编号\r\n        procDefId: \"\",  // 流程编号\r\n      },\r\n      variablesData: {}, // 流程变量数据\r\n    };\r\n  },\r\n  created() {\r\n    this.taskForm.deployId = this.$route.query && this.$route.query.deployId;\r\n    this.taskForm.taskId  = this.$route.query && this.$route.query.taskId;\r\n    this.taskForm.procInsId = this.$route.query && this.$route.query.procInsId;\r\n    // 回显流程记录\r\n    // 流程任务重获取变量表单\r\n    this.processVariables( this.taskForm.taskId)\r\n    this.getFlowRecordList(this.taskForm.procInsId, this.taskForm.deployId);\r\n  },\r\n  methods: {\r\n    handleClick(tab, event) {\r\n      if (tab.name === '3'){\r\n        flowXmlAndNode({procInsId:this.taskForm.procInsId,deployId:this.taskForm.deployId}).then(res => {\r\n          this.flowData = res.data;\r\n        })\r\n      }\r\n    },\r\n    getFlowViewer(procInsId,executionId) {\r\n      getFlowViewer(procInsId,executionId).then(res => {\r\n        this.taskList = res.data\r\n      })\r\n    },\r\n    setIcon(val) {\r\n      if (val) {\r\n        return \"el-icon-check\";\r\n      } else {\r\n        return \"el-icon-time\";\r\n      }\r\n    },\r\n    setColor(val) {\r\n      if (val) {\r\n        return \"#2bc418\";\r\n      } else {\r\n        return \"#b3bdbb\";\r\n      }\r\n    },\r\n    /** 流程流转记录 */\r\n    getFlowRecordList(procInsId, deployId) {\r\n      const that = this\r\n      const params = {procInsId: procInsId, deployId: deployId}\r\n      flowRecord(params).then(res => {\r\n        that.flowRecordList = res.data.flowList;\r\n      }).catch(res => {\r\n        this.goBack();\r\n      })\r\n    },\r\n    fillFormData(form, data) {\r\n      form.fields.forEach((item) => {\r\n        const vModel = item.__vModel__;\r\n        const val = data[item.__vModel__];\r\n\r\n        // 特殊处理el-upload，回显图片\r\n        if (item.__config__.tag === \"el-upload\") {\r\n          // 回显图片\r\n          item[\"file-list\"] = (val || []).map((url) => ({\r\n            name: `${vModel}${i}`,\r\n            url,\r\n          }));\r\n        }\r\n\r\n        if (val) {\r\n          item.__config__.defaultValue = val;\r\n        }\r\n      });\r\n    },\r\n    /** 获取流程变量内容 */\r\n    processVariables(taskId) {\r\n      if (taskId) {\r\n        // 提交流程申请时填写的表单存入了流程变量中后续任务处理时需要展示\r\n        getProcessVariables(taskId).then(res => {\r\n          this.variablesData = res.data.variables;\r\n        });\r\n      }\r\n    },\r\n    /** 返回页面 */\r\n    goBack() {\r\n      // 关闭当前标签页并返回上个页面\r\n      const obj = { path: \"/task/process\", query: { t: Date.now()} };\r\n      this.$tab.closeOpenPage(obj);\r\n    },\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.test-form {\r\n  margin: 15px auto;\r\n  width: 800px;\r\n  padding: 15px;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n.clearfix:after {\r\n  clear: both\r\n}\r\n\r\n.box-card {\r\n  width: 100%;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.el-tag + .el-tag {\r\n  margin-left: 10px;\r\n}\r\n\r\n.my-label {\r\n  background: #E1F3D8;\r\n}\r\n</style>\r\n"]}]}