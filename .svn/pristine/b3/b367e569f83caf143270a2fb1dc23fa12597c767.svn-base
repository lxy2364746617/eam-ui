{"remainingRequest":"E:\\qrhpro\\cms-eam-ui\\node_modules\\babel-loader\\lib\\index.js!E:\\qrhpro\\cms-eam-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\qrhpro\\cms-eam-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\qrhpro\\cms-eam-ui\\src\\components\\tinymce\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\qrhpro\\cms-eam-ui\\src\\components\\tinymce\\index.vue","mtime":1693791859518},{"path":"E:\\qrhpro\\cms-eam-ui\\babel.config.js","mtime":1693791556521},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693791616229},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1693791596985},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1693791616229},{"path":"E:\\qrhpro\\cms-eam-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1693791844037}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJFOi9xcmhwcm8vY21zLWVhbS11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyIpOwp2YXIgX2xvYWRUaW55bWNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL3V0aWxzL2xvYWRUaW55bWNlIikpOwp2YXIgX2NvbmZpZyA9IHJlcXVpcmUoIi4vY29uZmlnIik7CnZhciBfdGhyb3R0bGVEZWJvdW5jZSA9IHJlcXVpcmUoInRocm90dGxlLWRlYm91bmNlIik7Ci8vCi8vCi8vCi8vCgp2YXIgbnVtID0gMTsKdmFyIF9kZWZhdWx0MiA9IHsKICBwcm9wczogewogICAgaWQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICBudW0gPT09IDEwMDAwICYmIChudW0gPSAxKTsKICAgICAgICByZXR1cm4gInRpbnltY2UiLmNvbmNhdCgrbmV3IERhdGUoKSkuY29uY2F0KG51bSsrKTsKICAgICAgfQogICAgfSwKICAgIHZhbHVlOiB7CiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGlueW1jZUlkOiB0aGlzLmlkCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAoMCwgX2xvYWRUaW55bWNlLmRlZmF1bHQpKGZ1bmN0aW9uICh0aW55bWNlKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBnbG9iYWwtcmVxdWlyZQogICAgICByZXF1aXJlKCcuL3poX0NOJyk7CiAgICAgIHZhciBjb25mID0gewogICAgICAgIHNlbGVjdG9yOiAiIyIuY29uY2F0KF90aGlzLnRpbnltY2VJZCksCiAgICAgICAgbGFuZ3VhZ2U6ICd6aF9DTicsCiAgICAgICAgbWVudWJhcjogJ2ZpbGUgZWRpdCBpbnNlcnQgdmlldyBmb3JtYXQgdGFibGUnLAogICAgICAgIHBsdWdpbnM6IF9jb25maWcucGx1Z2lucywKICAgICAgICB0b29sYmFyOiBfY29uZmlnLnRvb2xiYXIsCiAgICAgICAgaGVpZ2h0OiAzMDAsCiAgICAgICAgYnJhbmRpbmc6IGZhbHNlLAogICAgICAgIG9iamVjdF9yZXNpemluZzogZmFsc2UsCiAgICAgICAgZW5kX2NvbnRhaW5lcl9vbl9lbXB0eV9ibG9jazogdHJ1ZSwKICAgICAgICBwb3dlcnBhc3RlX3dvcmRfaW1wb3J0OiAnY2xlYW4nLAogICAgICAgIGNvZGVfZGlhbG9nX2hlaWdodDogNDUwLAogICAgICAgIGNvZGVfZGlhbG9nX3dpZHRoOiAxMDAwLAogICAgICAgIGFkdmxpc3RfYnVsbGV0X3N0eWxlczogJ3NxdWFyZScsCiAgICAgICAgYWR2bGlzdF9udW1iZXJfc3R5bGVzOiAnZGVmYXVsdCcsCiAgICAgICAgZGVmYXVsdF9saW5rX3RhcmdldDogJ19ibGFuaycsCiAgICAgICAgbGlua190aXRsZTogZmFsc2UsCiAgICAgICAgbm9uYnJlYWtpbmdfZm9yY2VfdGFiOiB0cnVlCiAgICAgIH07CiAgICAgIGNvbmYgPSBPYmplY3QuYXNzaWduKGNvbmYsIF90aGlzLiRhdHRycyk7CiAgICAgIGNvbmYuaW5pdF9pbnN0YW5jZV9jYWxsYmFjayA9IGZ1bmN0aW9uIChlZGl0b3IpIHsKICAgICAgICBpZiAoX3RoaXMudmFsdWUpIGVkaXRvci5zZXRDb250ZW50KF90aGlzLnZhbHVlKTsKICAgICAgICBfdGhpcy52TW9kZWwoZWRpdG9yKTsKICAgICAgfTsKICAgICAgdGlueW1jZS5pbml0KGNvbmYpOwogICAgfSk7CiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIHRoaXMuZGVzdHJveVRpbnltY2UoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHZNb2RlbDogZnVuY3Rpb24gdk1vZGVsKGVkaXRvcikgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgLy8g5o6n5Yi26L+e57ut5YaZ5YWl5pe2c2V0Q29udGVudOeahOinpuWPkemikeeOhwogICAgICB2YXIgZGVib3VuY2VTZXRDb250ZW50ID0gKDAsIF90aHJvdHRsZURlYm91bmNlLmRlYm91bmNlKSgyNTAsIGVkaXRvci5zZXRDb250ZW50KTsKICAgICAgdGhpcy4kd2F0Y2goJ3ZhbHVlJywgZnVuY3Rpb24gKHZhbCwgcHJldlZhbCkgewogICAgICAgIGlmIChlZGl0b3IgJiYgdmFsICE9PSBwcmV2VmFsICYmIHZhbCAhPT0gZWRpdG9yLmdldENvbnRlbnQoKSkgewogICAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB2YWwgPSB2YWwudG9TdHJpbmcoKTsKICAgICAgICAgIGRlYm91bmNlU2V0Q29udGVudC5jYWxsKGVkaXRvciwgdmFsKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBlZGl0b3Iub24oJ2NoYW5nZSBrZXl1cCB1bmRvIHJlZG8nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLiRlbWl0KCdpbnB1dCcsIGVkaXRvci5nZXRDb250ZW50KCkpOwogICAgICB9KTsKICAgIH0sCiAgICBkZXN0cm95VGlueW1jZTogZnVuY3Rpb24gZGVzdHJveVRpbnltY2UoKSB7CiAgICAgIGlmICghd2luZG93LnRpbnltY2UpIHJldHVybjsKICAgICAgdmFyIHRpbnltY2UgPSB3aW5kb3cudGlueW1jZS5nZXQodGhpcy50aW55bWNlSWQpOwogICAgICBpZiAodGlueW1jZSkgewogICAgICAgIHRpbnltY2UuZGVzdHJveSgpOwogICAgICB9CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDI7"},{"version":3,"names":["_loadTinymce","_interopRequireDefault","require","_config","_throttleDebounce","num","_default2","props","id","type","String","default","_default","concat","Date","value","data","tinymceId","mounted","_this","loadTinymce","tinymce","conf","selector","language","menubar","plugins","toolbar","height","branding","object_resizing","end_container_on_empty_block","powerpaste_word_import","code_dialog_height","code_dialog_width","advlist_bullet_styles","advlist_number_styles","default_link_target","link_title","nonbreaking_force_tab","Object","assign","$attrs","init_instance_callback","editor","setContent","vModel","init","destroyed","destroyTinymce","methods","_this2","debounceSetContent","debounce","$watch","val","prevVal","getContent","toString","call","on","$emit","window","get","destroy","exports"],"sources":["src/components/tinymce/index.vue"],"sourcesContent":["<template>\r\n  <textarea :id=\"tinymceId\" style=\"visibility: hidden\" />\r\n</template>\r\n\r\n<script>\r\nimport loadTinymce from '@/utils/loadTinymce'\r\nimport { plugins, toolbar } from './config'\r\nimport { debounce } from 'throttle-debounce'\r\n\r\nlet num = 1\r\n\r\nexport default {\r\n  props: {\r\n    id: {\r\n      type: String,\r\n      default: () => {\r\n        num === 10000 && (num = 1)\r\n        return `tinymce${+new Date()}${num++}`\r\n      }\r\n    },\r\n    value: {\r\n      default: ''\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      tinymceId: this.id\r\n    }\r\n  },\r\n  mounted() {\r\n    loadTinymce(tinymce => {\r\n      // eslint-disable-next-line global-require\r\n      require('./zh_CN')\r\n      let conf = {\r\n        selector: `#${this.tinymceId}`,\r\n        language: 'zh_CN',\r\n        menubar: 'file edit insert view format table',\r\n        plugins,\r\n        toolbar,\r\n        height: 300,\r\n        branding: false,\r\n        object_resizing: false,\r\n        end_container_on_empty_block: true,\r\n        powerpaste_word_import: 'clean',\r\n        code_dialog_height: 450,\r\n        code_dialog_width: 1000,\r\n        advlist_bullet_styles: 'square',\r\n        advlist_number_styles: 'default',\r\n        default_link_target: '_blank',\r\n        link_title: false,\r\n        nonbreaking_force_tab: true\r\n      }\r\n      conf = Object.assign(conf, this.$attrs)\r\n      conf.init_instance_callback = editor => {\r\n        if (this.value) editor.setContent(this.value)\r\n        this.vModel(editor)\r\n      }\r\n      tinymce.init(conf)\r\n    })\r\n  },\r\n  destroyed() {\r\n    this.destroyTinymce()\r\n  },\r\n  methods: {\r\n    vModel(editor) {\r\n      // 控制连续写入时setContent的触发频率\r\n      const debounceSetContent = debounce(250, editor.setContent)\r\n      this.$watch('value', (val, prevVal) => {\r\n        if (editor && val !== prevVal && val !== editor.getContent()) {\r\n          if (typeof val !== 'string') val = val.toString()\r\n          debounceSetContent.call(editor, val)\r\n        }\r\n      })\r\n\r\n      editor.on('change keyup undo redo', () => {\r\n        this.$emit('input', editor.getContent())\r\n      })\r\n    },\r\n    destroyTinymce() {\r\n      if (!window.tinymce) return\r\n      const tinymce = window.tinymce.get(this.tinymceId)\r\n      if (tinymce) {\r\n        tinymce.destroy()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":";;;;;;;;;;AAKA,IAAAA,YAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AACA,IAAAE,iBAAA,GAAAF,OAAA;;;;;;AAEA,IAAAG,GAAA;AAAA,IAAAC,SAAA,GAEA;EACAC,KAAA;IACAC,EAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA,WAAAC,SAAA;QACAP,GAAA,eAAAA,GAAA;QACA,iBAAAQ,MAAA,MAAAC,IAAA,IAAAD,MAAA,CAAAR,GAAA;MACA;IACA;IACAU,KAAA;MACAJ,OAAA;IACA;EACA;EACAK,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA,OAAAT;IACA;EACA;EACAU,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA,IAAAC,oBAAA,YAAAC,OAAA;MACA;MACAnB,OAAA;MACA,IAAAoB,IAAA;QACAC,QAAA,MAAAV,MAAA,CAAAM,KAAA,CAAAF,SAAA;QACAO,QAAA;QACAC,OAAA;QACAC,OAAA,EAAAA,eAAA;QACAC,OAAA,EAAAA,eAAA;QACAC,MAAA;QACAC,QAAA;QACAC,eAAA;QACAC,4BAAA;QACAC,sBAAA;QACAC,kBAAA;QACAC,iBAAA;QACAC,qBAAA;QACAC,qBAAA;QACAC,mBAAA;QACAC,UAAA;QACAC,qBAAA;MACA;MACAjB,IAAA,GAAAkB,MAAA,CAAAC,MAAA,CAAAnB,IAAA,EAAAH,KAAA,CAAAuB,MAAA;MACApB,IAAA,CAAAqB,sBAAA,aAAAC,MAAA;QACA,IAAAzB,KAAA,CAAAJ,KAAA,EAAA6B,MAAA,CAAAC,UAAA,CAAA1B,KAAA,CAAAJ,KAAA;QACAI,KAAA,CAAA2B,MAAA,CAAAF,MAAA;MACA;MACAvB,OAAA,CAAA0B,IAAA,CAAAzB,IAAA;IACA;EACA;EACA0B,SAAA,WAAAA,UAAA;IACA,KAAAC,cAAA;EACA;EACAC,OAAA;IACAJ,MAAA,WAAAA,OAAAF,MAAA;MAAA,IAAAO,MAAA;MACA;MACA,IAAAC,kBAAA,OAAAC,0BAAA,OAAAT,MAAA,CAAAC,UAAA;MACA,KAAAS,MAAA,oBAAAC,GAAA,EAAAC,OAAA;QACA,IAAAZ,MAAA,IAAAW,GAAA,KAAAC,OAAA,IAAAD,GAAA,KAAAX,MAAA,CAAAa,UAAA;UACA,WAAAF,GAAA,eAAAA,GAAA,GAAAA,GAAA,CAAAG,QAAA;UACAN,kBAAA,CAAAO,IAAA,CAAAf,MAAA,EAAAW,GAAA;QACA;MACA;MAEAX,MAAA,CAAAgB,EAAA;QACAT,MAAA,CAAAU,KAAA,UAAAjB,MAAA,CAAAa,UAAA;MACA;IACA;IACAR,cAAA,WAAAA,eAAA;MACA,KAAAa,MAAA,CAAAzC,OAAA;MACA,IAAAA,OAAA,GAAAyC,MAAA,CAAAzC,OAAA,CAAA0C,GAAA,MAAA9C,SAAA;MACA,IAAAI,OAAA;QACAA,OAAA,CAAA2C,OAAA;MACA;IACA;EACA;AACA;AAAAC,OAAA,CAAAtD,OAAA,GAAAL,SAAA"}]}